<%
   game_id = @game_id
   subject = @subject
   question = @question
   bonus = @bonus
   answers = [question.rightAns, question.wrongAns1, question.wrongAns2, question.wrongAns3]
   answers = answers.shuffle
   correct_answer = question.rightAns
   result = ""
%>

<html>
<%= stylesheet_link_tag "game.css.scss", media: "all", "data-turbolinks-track" => true %>
<%= javascript_include_tag "jquery.progressTimer" %>

<div style="display: none;">

  <p id="game_id"><%= game_id %></p>

  <p id="subject"><%= subject %></p>

  <p id="bonus"><%= bonus %></p>

  <p id="correct_answer"><%= correct_answer %></p>

  <p id="play_sounds"><%= current_user.play_sounds %></p>
</div>


<body style="background-color: lightblue;">

<div class="container"></div>


<audio id="ticktock" loop>
  <source src="/assets/tick_tock.mp3" type="audio/mpeg">
  <source src="/assets/tick_tock.ogg" type="audio/ogg">
</audio>
<audio id="wrong">
  <source src="/assets/wrong.mp3" type="audio/mpeg">
  <source src="/assets/wrong.ogg" type="audio/ogg">
</audio>

<audio id="right">
  <source src="/assets/right.mp3" type="audio/mpeg">
  <source src="/assets/right.ogg" type="audio/ogg">
</audio>


<script type="text/javascript">
    var timerSound = document.getElementById("ticktock");
    var wrongSound = document.getElementById("wrong");
    var rightSound = document.getElementById("right");
    var sound = document.getElementById("play_sounds").innerHTML;
    if (sound == "false") {
        timerSound.muted = true;
        wrongSound.muted = true;
        rightSound.muted = true;
    }
</script>


<div class="container bg-info" id="question" data-backdrop="static" data-keyboard="false" style="width: 60%; height: 100%; background-color: lightblue;">

  <div class="container" style="width: 80%; margin-left: 25%; margin-right: 25%">



    <div id="progressTimer"></div>


    <h2><span class="label label-warning" id="qid"><%= @question.subject_title %></span>

      <h2 class="questionTitle" style="padding: 5px;"><%= @question.title %></h2>
    </h2>

    <div class="col-xs-3 col-xs-offset-5">
      <div id="loadbar" style="display: none;">
        <div class="blockG" id="rotateG_01"></div>
        <div class="blockG" id="rotateG_02"></div>
        <div class="blockG" id="rotateG_03"></div>
        <div class="blockG" id="rotateG_04"></div>
        <div class="blockG" id="rotateG_05"></div>
        <div class="blockG" id="rotateG_06"></div>
        <div class="blockG" id="rotateG_07"></div>
        <div class="blockG" id="rotateG_08"></div>
      </div>
    </div>

    <p>Correct Answer: <%= answers.index(question.rightAns) %></p>

    <div class="container" id="answer_selection">
      <div class="[ col-xs-12 col-sm-6 ]">


        <option value="<%= answers[0] %>" class="btn btn-primary btn-lg" style="width: 90%; margin-left: 1%; margin-bottom: 2px;" >
          <%= answers[0] %>
        </option></br>


        <option value="<%= answers[1] %>" class="btn btn-primary btn-lg" style="width: 90%; margin-left: 1%; margin-bottom: 2px;" >
          <%= answers[1] %>
        </option></br>


        <option value="<%= answers[2] %>" class="btn btn-primary btn-lg" style="width: 90%; margin-left: 1%; margin-bottom: 2px;" >
          <%= answers[2] %>
        </option></br>


        <option value="<%= answers[3] %>" class="btn btn-primary btn-lg" style="width: 90%; margin-left: 1%; margin-bottom: 15px;" >
          <%= answers[3] %>
        </option></br>

      </div>


    </div>

    <button type="button" class="btn btn-large btn-primary" style="width: 100%;" onclick="CheckSolution()">Submit</button>
</div>

    <script>

        $("#progressTimer").progressTimer({});

        var answers_container = document.getElementById("answer_selection");
        var bonus = document.getElementById("bonus").innerHTML;
        var game_ID = document.getElementById("game_id").innerHTML;
        var correct_answer = document.getElementById("correct_answer").innerHTML;
        var user_answer = answers_container.options[answers_container.selectedIndex].value;

      function checkSolution(){
          stopTimer();

          if(correct_answer == user_answer)
          {
              correct();
          }
          else
          {
              incorrect();
          }
      }

      function correct(){
          var url = '/game/question_rating?result=CORRECT' + "&subject_title=" + subject + "&game_id=" + game_ID + "&bonus=" + bonus;
          Turbolinks.visit(url);
      }

      function incorrect(){
          var url = '/game/question_rating?result=INCORRECT' + "&subject_title=" + subject + "&game_id=" + game_ID + "&bonus=" + bonus;
          Turbolinks.visit(url);
      }

        function stopTimer(){
            var timer = document.getElementById("progressTimer");
            timer.clearInterval(interval);
        }


    </script>
  </div>
</div>
</body>
</html>